"use strict";class t{key;parent=null;children={};_store=new Set;constructor(t,r=[]){this.key=t,Array.isArray(r)&&(this._store=new Set(r))}addValues(t=[]){return(t||[]).forEach((t=>this._store.add(t))),this}setValues(t=[]){return this._store.clear(),this.addValues(t)}getValues(){return Array.from(this._store)}getWord(){let t=[],r=this;for(;null!==r;)t.unshift(r.key),r=r.parent;return t.join("")}getChildrenCount(){return Object.keys(this.children).length-1}}class r{static DUMP_VALUES_KEY="__";_root=new t(null);clear(){this._root=new t(null)}insert(r,e=null){let n=this._root;for(let o of r)n.children[o]?n.children[o].addValues(e):(n.children[o]=new t(o,e),n.children[o].parent=n),n=n.children[o]}find(t){let r=this._root;for(let e of t){if(!r.children[e])return null;r=r.children[e]}return r}remove(t){let r=this.find(t);if(!r)return!1;for(;r.parent.key;)delete r.children,delete r.parent.children[r.key],r=r.parent;return r.setValues(Object.values(r.children).reduce(((t,r)=>[...t,...r.getValues()]),[])),!0}toJSON(){return this.dump()}dump(){let t={};const e=(t,n)=>{for(let i of Object.values(t.children))n[i.key]||={[r.DUMP_VALUES_KEY]:[]},n[i.key][r.DUMP_VALUES_KEY]=(o=[...n[i.key][r.DUMP_VALUES_KEY],...i.getValues()],Array.from(new Set(o))),e(i,n[i.key]);var o};return e(this._root,t),t}restore(t){this.clear();const e={},n=(t,o)=>{for(let[i,s]of Object.entries(t))i!==r.DUMP_VALUES_KEY&&(o+=i,e[o]||=[],e[o]=[...e[o],...s[r.DUMP_VALUES_KEY]],n(t[i],o),o="")};return n(t,""),Object.entries(e).forEach((([t,r])=>this.insert(t,r))),this}}function e(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}var n="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")(),s=i.Symbol,a=Object.prototype,u=a.hasOwnProperty,l=a.toString,c=s?s.toStringTag:void 0;var h=Object.prototype.toString;var f="[object Null]",p="[object Undefined]",_=s?s.toStringTag:void 0;function d(t){return null==t?void 0===t?p:f:_&&_ in Object(t)?function(t){var r=u.call(t,c),e=t[c];try{t[c]=void 0;var n=!0}catch(t){}var o=l.call(t);return n&&(r?t[c]=e:delete t[c]),o}(t):function(t){return h.call(t)}(t)}function v(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)}var y="[object AsyncFunction]",g="[object Function]",b="[object GeneratorFunction]",S="[object Proxy]";function j(t){if(!v(t))return!1;var r=d(t);return r==g||r==b||r==y||r==S}var O,m=i["__core-js_shared__"],w=(O=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"";var A=Function.prototype.toString;var E=/^\[object .+?Constructor\]$/,z=Function.prototype,V=Object.prototype,P=z.toString,k=V.hasOwnProperty,U=RegExp("^"+P.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function x(t){return!(!v(t)||(r=t,w&&w in r))&&(j(t)?U:E).test(function(t){if(null!=t){try{return A.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var r}function M(t,r){var e=function(t,r){return null==t?void 0:t[r]}(t,r);return x(e)?e:void 0}var L=M(Object,"create");var D="__lodash_hash_undefined__",W=Object.prototype.hasOwnProperty;var F=Object.prototype.hasOwnProperty;var $="__lodash_hash_undefined__";function K(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function Y(t,r){for(var e,n,o=t.length;o--;)if((e=t[o][0])===(n=r)||e!=e&&n!=n)return o;return-1}K.prototype.clear=function(){this.__data__=L?L(null):{},this.size=0},K.prototype.delete=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},K.prototype.get=function(t){var r=this.__data__;if(L){var e=r[t];return e===D?void 0:e}return W.call(r,t)?r[t]:void 0},K.prototype.has=function(t){var r=this.__data__;return L?void 0!==r[t]:F.call(r,t)},K.prototype.set=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=L&&void 0===r?$:r,this};var N=Array.prototype.splice;function q(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(t){var r=this.__data__,e=Y(r,t);return!(e<0)&&(e==r.length-1?r.pop():N.call(r,e,1),--this.size,!0)},q.prototype.get=function(t){var r=this.__data__,e=Y(r,t);return e<0?void 0:r[e][1]},q.prototype.has=function(t){return Y(this.__data__,t)>-1},q.prototype.set=function(t,r){var e=this.__data__,n=Y(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};var C=M(i,"Map");function R(t,r){var e,n,o=t.__data__;return("string"==(n=typeof(e=r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof r?"string":"hash"]:o.map}function T(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}T.prototype.clear=function(){this.size=0,this.__data__={hash:new K,map:new(C||q),string:new K}},T.prototype.delete=function(t){var r=R(this,t).delete(t);return this.size-=r?1:0,r},T.prototype.get=function(t){return R(this,t).get(t)},T.prototype.has=function(t){return R(this,t).has(t)},T.prototype.set=function(t,r){var e=R(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};var I="__lodash_hash_undefined__";function J(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new T;++r<e;)this.add(t[r])}function Q(t){return t!=t}function B(t,r){return!!(null==t?0:t.length)&&function(t,r,e){return r==r?function(t,r,e){for(var n=e-1,o=t.length;++n<o;)if(t[n]===r)return n;return-1}(t,r,e):function(t,r,e,n){for(var o=t.length,i=e+(n?1:-1);n?i--:++i<o;)if(r(t[i],i,t))return i;return-1}(t,Q,e)}(t,r,0)>-1}function G(t,r,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(e(r,t[n]))return!0;return!1}function H(t){return function(r){return t(r)}}function X(t,r){return t.has(r)}J.prototype.add=J.prototype.push=function(t){return this.__data__.set(t,I),this},J.prototype.has=function(t){return this.__data__.has(t)};var Z=Math.min;function tt(t){return t}var rt=Math.max;var et=function(){try{var t=M(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),nt=et?function(t,r){return et(t,"toString",{configurable:!0,enumerable:!1,value:(e=r,function(){return e}),writable:!0});var e}:tt,ot=800,it=16,st=Date.now;var at,ut,lt,ct=(at=nt,ut=0,lt=0,function(){var t=st(),r=it-(t-lt);if(lt=t,r>0){if(++ut>=ot)return arguments[0]}else ut=0;return at.apply(void 0,arguments)});var ht=9007199254740991;function ft(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ht}(t.length)&&!j(t)}function pt(t){return function(t){return function(t){return null!=t&&"object"==typeof t}(t)&&ft(t)}(t)?t:[]}var _t=function(t,r){return ct(function(t,r,e){return r=rt(void 0===r?t.length-1:r,0),function(){for(var n=arguments,o=-1,i=rt(n.length-r,0),s=Array(i);++o<i;)s[o]=n[r+o];o=-1;for(var a=Array(r+1);++o<r;)a[o]=n[o];return a[r]=e(s),function(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}(t,this,a)}}(t,r,tt),t+"")}((function(t){var r=e(t,pt);return r.length&&r[0]===t[0]?function(t,r,n){for(var o=n?G:B,i=t[0].length,s=t.length,a=s,u=Array(s),l=1/0,c=[];a--;){var h=t[a];a&&r&&(h=e(h,H(r))),l=Z(h.length,l),u[a]=!n&&(r||i>=120&&h.length>=120)?new J(a&&h):void 0}h=t[0];var f=-1,p=u[0];t:for(;++f<i&&c.length<l;){var _=h[f],d=r?r(_):_;if(_=n||0!==_?_:0,!(p?X(p,d):o(c,d,n))){for(a=s;--a;){var v=u[a];if(!(v?X(v,d):o(t[a],d,n)))continue t}p&&p.push(d),c.push(_)}}return c}(r):[]}));class dt{options;static defaultOptions={caseSensitive:!1,accentSensitive:!1,isStopword:t=>!1,normalizeWord:t=>t,processResults:(t,r)=>t,parseQuery:t=>({query:t,operators:null}),querySomeWordMinLength:1};_index=new r;constructor(t={}){this.options=t,this.options={...dt.defaultOptions,...this.options}}clear(){return this._index.clear(),this}static normalizeInput=t=>`${t}`.replace(/\s+/g," ").trim();toWords(t){let r=dt.normalizeInput(t).split(" ").filter((t=>t&&!this.options.isStopword(t)));return r=r.reduce(((t,r)=>((r=this.options.normalizeWord(r))&&Array.isArray(r)?t=[...t,...r]:r&&t.push(r),t)),[]),r=r.map((t=>(t&&this.options.isStopword(t)&&(t=null),t&&!this.options.caseSensitive&&(t=t.toLowerCase()),t&&!this.options.accentSensitive&&(t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),t))).filter(Boolean),Array.from(new Set(r))}add(t,r){if(void 0===r)return!1;const e=this.toWords(t);return!!e.length&&(e.forEach((t=>this._index.insert(t,[r]))),!0)}search(t){const{parseQuery:r,querySomeWordMinLength:e,processResults:n}=this.options,o=r(t),i=o.operators&&Object.keys(o.operators).length>0,s=this.toWords(o.query);if(!i&&!s.length)return[];if(!i&&!s.some((t=>t.length>=e)))return[];s.length;const a=[];for(let t of s){const r=this._index.find(t);if(!r)return[];a.push(r.getValues())}return n(_t(...a),o)}dump(){return JSON.stringify(this._index.dump())}restore(t){return"string"==typeof t&&(t=JSON.parse(t)),this._index.restore(t),this}}exports.Searchable=dt,exports.Trie=r;
