!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).searchable={})}(this,(function(t){"use strict";class e{key;parent=null;children={};_store=new Set;constructor(t,e=[]){this.key=t,Array.isArray(e)&&(this._store=new Set(e))}addValues(t=[]){return(t||[]).forEach((t=>this._store.add(t))),this}setValues(t=[]){return this._store.clear(),this.addValues(t)}getValues(){return Array.from(this._store)}getWord(){let t=[],e=this;for(;null!==e;)t.unshift(e.key),e=e.parent;return t.join("")}getChildrenCount(){return Object.keys(this.children).length-1}}class r{static DUMP_VALUES_KEY="__";_root=new e(null);clear(){this._root=new e(null)}insert(t,r=null){let n=this._root;for(let o of t)n.children[o]?n.children[o].addValues(r):(n.children[o]=new e(o,r),n.children[o].parent=n),n=n.children[o]}find(t){let e=this._root;for(let r of t){if(!e.children[r])return null;e=e.children[r]}return e}remove(t){let e=this.find(t);if(!e)return!1;for(;e.parent.key;)delete e.children,delete e.parent.children[e.key],e=e.parent;return e.setValues(Object.values(e.children).reduce(((t,e)=>[...t,...e.getValues()]),[])),!0}toJSON(){return this.dump()}dump(){let t={};const e=(t,n)=>{for(let i of Object.values(t.children))n[i.key]||={[r.DUMP_VALUES_KEY]:[]},n[i.key][r.DUMP_VALUES_KEY]=(o=[...n[i.key][r.DUMP_VALUES_KEY],...i.getValues()],Array.from(new Set(o))),e(i,n[i.key]);var o};return e(this._root,t),t}restore(t){this.clear();const e={},n=(t,o)=>{for(let[i,s]of Object.entries(t))i!==r.DUMP_VALUES_KEY&&(o+=i,e[o]||=[],e[o]=[...e[o],...s[r.DUMP_VALUES_KEY]],n(t[i],o),o="")};return n(t,""),Object.entries(e).forEach((([t,e])=>this.insert(t,e))),this}}function n(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var o="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,s=o||i||Function("return this")(),a=s.Symbol,u=Object.prototype,l=u.hasOwnProperty,c=u.toString,h=a?a.toStringTag:void 0;var f=Object.prototype.toString;var p="[object Null]",_="[object Undefined]",d=a?a.toStringTag:void 0;function y(t){return null==t?void 0===t?_:p:d&&d in Object(t)?function(t){var e=l.call(t,h),r=t[h];try{t[h]=void 0;var n=!0}catch(t){}var o=c.call(t);return n&&(e?t[h]=r:delete t[h]),o}(t):function(t){return f.call(t)}(t)}function v(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var g="[object AsyncFunction]",b="[object Function]",j="[object GeneratorFunction]",S="[object Proxy]";function m(t){if(!v(t))return!1;var e=y(t);return e==b||e==j||e==g||e==S}var O,w=s["__core-js_shared__"],A=(O=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"";var E=Function.prototype.toString;var z=/^\[object .+?Constructor\]$/,V=Function.prototype,P=Object.prototype,k=V.toString,x=P.hasOwnProperty,U=RegExp("^"+k.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function M(t){return!(!v(t)||(e=t,A&&A in e))&&(m(t)?U:z).test(function(t){if(null!=t){try{return E.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function L(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return M(r)?r:void 0}var D=L(Object,"create");var W="__lodash_hash_undefined__",F=Object.prototype.hasOwnProperty;var $=Object.prototype.hasOwnProperty;var K="__lodash_hash_undefined__";function T(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Y(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}T.prototype.clear=function(){this.__data__=D?D(null):{},this.size=0},T.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},T.prototype.get=function(t){var e=this.__data__;if(D){var r=e[t];return r===W?void 0:r}return F.call(e,t)?e[t]:void 0},T.prototype.has=function(t){var e=this.__data__;return D?void 0!==e[t]:$.call(e,t)},T.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=D&&void 0===e?K:e,this};var N=Array.prototype.splice;function q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(t){var e=this.__data__,r=Y(e,t);return!(r<0)&&(r==e.length-1?e.pop():N.call(e,r,1),--this.size,!0)},q.prototype.get=function(t){var e=this.__data__,r=Y(e,t);return r<0?void 0:e[r][1]},q.prototype.has=function(t){return Y(this.__data__,t)>-1},q.prototype.set=function(t,e){var r=this.__data__,n=Y(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var C=L(s,"Map");function R(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function I(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}I.prototype.clear=function(){this.size=0,this.__data__={hash:new T,map:new(C||q),string:new T}},I.prototype.delete=function(t){var e=R(this,t).delete(t);return this.size-=e?1:0,e},I.prototype.get=function(t){return R(this,t).get(t)},I.prototype.has=function(t){return R(this,t).has(t)},I.prototype.set=function(t,e){var r=R(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var J="__lodash_hash_undefined__";function Q(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new I;++e<r;)this.add(t[e])}function B(t){return t!=t}function G(t,e){return!!(null==t?0:t.length)&&function(t,e,r){return e==e?function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r):function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,B,r)}(t,e,0)>-1}function H(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1}function X(t){return function(e){return t(e)}}function Z(t,e){return t.has(e)}Q.prototype.add=Q.prototype.push=function(t){return this.__data__.set(t,J),this},Q.prototype.has=function(t){return this.__data__.has(t)};var tt=Math.min;function et(t){return t}var rt=Math.max;var nt=function(){try{var t=L(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),ot=nt?function(t,e){return nt(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:et,it=800,st=16,at=Date.now;var ut,lt,ct,ht=(ut=ot,lt=0,ct=0,function(){var t=at(),e=st-(t-ct);if(ct=t,e>0){if(++lt>=it)return arguments[0]}else lt=0;return ut.apply(void 0,arguments)});var ft=9007199254740991;function pt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ft}(t.length)&&!m(t)}function _t(t){return function(t){return function(t){return null!=t&&"object"==typeof t}(t)&&pt(t)}(t)?t:[]}var dt=function(t,e){return ht(function(t,e,r){return e=rt(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=rt(n.length-e,0),s=Array(i);++o<i;)s[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(s),function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(t,e,et),t+"")}((function(t){var e=n(t,_t);return e.length&&e[0]===t[0]?function(t,e,r){for(var o=r?H:G,i=t[0].length,s=t.length,a=s,u=Array(s),l=1/0,c=[];a--;){var h=t[a];a&&e&&(h=n(h,X(e))),l=tt(h.length,l),u[a]=!r&&(e||i>=120&&h.length>=120)?new Q(a&&h):void 0}h=t[0];var f=-1,p=u[0];t:for(;++f<i&&c.length<l;){var _=h[f],d=e?e(_):_;if(_=r||0!==_?_:0,!(p?Z(p,d):o(c,d,r))){for(a=s;--a;){var y=u[a];if(!(y?Z(y,d):o(t[a],d,r)))continue t}p&&p.push(d),c.push(_)}}return c}(e):[]}));class yt{options;static defaultOptions={caseSensitive:!1,accentSensitive:!1,isStopword:t=>!1,normalizeWord:t=>t,processResults:(t,e)=>t,parseQuery:t=>({query:t,operators:null}),querySomeWordMinLength:1};_index=new r;constructor(t={}){this.options=t,this.options={...yt.defaultOptions,...this.options}}clear(){return this._index.clear(),this}static normalizeInput=t=>`${t}`.replace(/\s+/g," ").trim();toWords(t){let e=yt.normalizeInput(t).split(" ").filter((t=>t&&!this.options.isStopword(t)));return e=e.reduce(((t,e)=>((e=this.options.normalizeWord(e))&&Array.isArray(e)?t=[...t,...e]:e&&t.push(e),t)),[]),e=e.map((t=>(t&&this.options.isStopword(t)&&(t=null),t&&!this.options.caseSensitive&&(t=t.toLowerCase()),t&&!this.options.accentSensitive&&(t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),t))).filter(Boolean),Array.from(new Set(e))}add(t,e){if(void 0===e)return!1;const r=this.toWords(t);return!!r.length&&(r.forEach((t=>this._index.insert(t,[e]))),!0)}search(t){const{parseQuery:e,querySomeWordMinLength:r,processResults:n}=this.options,o=e(t),i=o.operators&&Object.keys(o.operators).length>0,s=this.toWords(o.query);if(!i&&!s.length)return[];if(!i&&!s.some((t=>t.length>=r)))return[];s.length;const a=[];for(let t of s){const e=this._index.find(t);if(!e)return[];a.push(e.getValues())}return n(dt(...a),o)}dump(){return JSON.stringify(this._index.dump())}restore(t){return"string"==typeof t&&(t=JSON.parse(t)),this._index.restore(t),this}}t.Searchable=yt,t.Trie=r}));
